---
layout: single
title: "Mask R-CNN 논문 요약"
toc: true
toc_sticky: true
category: Segmentation
---

# Abstract
본 논문에서는 object instance segmentation task에 대한 simple, flexible, general한 framework에 대해 소개한다. 본 연구의 접근방식은 효과적으로 객체를 탐지하는 동시에 각각의 인스턴스에 대해 높은 수준의 segmentation mask를 생성한다. Mask R-CNN은
Fast R-CNN에 layer를 확장시켜 object mask를 병렬로 예측하고 기존의 box recognition도 그대로 수행할 수 있다. Mask R-CNN은 학습이 쉽고 Faster R-CNN보다 연산이 크게 추가되지 않은 5 fps의 속도로 동작한다. 나아가, 사람의 동작을 예측하는 task 등 다양한 task를
수행할 수 있다. COCO datset에서 instance segmentation, bounding box object detection, person keypoint detection에 대해 좋은 성적을 거두었다. COCO 2016을 우승팀을 포함하여 기존에 존재한 모든 single model보다 우수한 성적을 거두었다. 본 연구가
향후 instance-level recognition 분야에 큰 도움이 되길 바란다.

<br><br>

# Details
## Introduction
- Object detectionr과 semantic segmentation은 Fast/Faster R-CNN과 FCN과 같은 좋은 baseline으로 짧은 기간동안 많은 발전을 이뤘다.
- 본 연구의 목표는 다른 task들과 비슷한 수준으로 instance segmentation이 가능한 framework를 만드는 것이다.
- Instance segmentation은 모든 객체에 대해 정확한 detection과 segmentation이 필요하기때문에 어렵다. 따라서, 복잡한 방법이 좋은 결과를 불러올 것이라고 생각했는데 굉장히 단순하고 유연하고 빠른 시스템이 instance segmentation의 SOTA를 넘었다.
- Mask R-CNN은 Faster R-CNN을 확장시켜 각 RoI에 대해 segmentation mask를 예측하고, 병렬적으로 기존과 같이 classification, bounding box regression을 수행한다. Mask branch는 작은 FCN이 RoI에 적용된 것이고 pixel 단위로 segmentation mask를 예측한다. 또한, mask branch는 작은 계산만 추가되기때문에 기존처럼 빠른 시스템을 만들 수 있었다.
- Faster R-CNN은 pixel-to-pixel로 설계되지 않았기때문에 **RoIPool**이 특징 추출을 위해 공간적인 정보를 coarse(거칠게. pooling을 수행하여 일부 공간정보가 손실되기때문에 이렇게 어느 정도 희생을 감소해서 특징을 추출하는 것을 coarse하다고 함)하게 추출한다. 이러한 misalignment 문제를 해결하기 위해 본 연구에서는 간단하고 공간적인 제약에서 자유로운 **RoIAlign** 기법을 사용해서 정확한 공간 위치를 잘 보존한다. 이 간단한 변화가 mask 정확도를 10%에서 50%까지 올렸다.
- 또한, mask와 class prediction을 분리하는 것이 매우 중요하다는 것을 알았다. 각각의 class끼리 영향을 주지않도록 class에 대해 binary mask를 독립적으로 수행했고, class를 예측하기위해서는 RoI classification에만 의존했다.
- 반면, FCN은 보통 픽셀단위에서 multi-class categorization을 수행하는데 이는 segmentation과 classification을 묶은 것이고, 이 방법은 경험상 instance segmentation 분야에서 좋지 않은 방법이다.
- Mask R-CNN은 종과 호루라기 말고는 COCO instance segmentation task에서 이전 대회의 SOTA를 뛰어넘었다. GPU에서 프레임당 200ms이 소요됐고 COCO dataset을 학습했을 때 하루에서 이틀 정도의 시간이 걸렸다. 이렇게 학습과 test가 빠르고 정확도도 뛰어나기때문에 향후 연구에 잘 쓰일 모델이라고 기대한다.
- Human pose estimation에서도 좋은 속도와 성능을 기록했다.

<br> 
<div align="center">
  <p>
  <img width="500" alt="image" src="https://github.com/Hyeonseung0103/Hyeonseung0103.github.io/assets/97672187/7db88c37-8c1c-4f7a-85a0-371ff7049cc1">
  </p>
</div>

<br>

<br><br>

## Related Work
**R-CNN**
- R-CNN은 빠르고 정확한 모델로 개선시키기위해 RoIPool을 사용하여 피처맵에서 미리 정의된 RoI에 대한 정보를 추출할 수 있도록했다.
- Faster R-CNN은 RPN을 사용해서 이 기술을 더 발전시켰고 다양한 방법을 동원해서 모델을 유연하고 강건하게 개선시켰다. 그리고 현재, object detection 분야를 이끌어나가는 모델이 되었다.

**Instance Segmentation**
- R-CNN의 영향으로 instance segmentation에 대한 많은 접근들이 segment proposals을 기반으로 이루어져있다.
- DeepMask와 이후의 연구들에서는 segment 후보를 제안하도록 학습한 후 Fast R-CNN을 통해 분류를 수행한다. 이 방법은 segmentation prededes(선행, 우선) recognition으로 느리고 정확도가 낮다는 단점이 있다.
- 본 연구에서는 mask와 class label에 대해 병렬로 예측을 수행해서 간단하고 유연한 모델을 만들었다.
- 가장 최근 Li의 연구에서는 segment proposal system과 object detection system을 결합한 fully convolutional instance segmentation(FCIS)를 개발했다. 이 모델은 positionsensitive output channels 집합을 fully convolutional하게 예측하는 것으로 이 채널이 object classes, boxes, masks를 동시에 처리해서 모델을 빠르게 한다.
- 하지만, FCIS는 overlapping instance에 의한 에러와 가짜 edges를 만들어 instance segmentation을 수행하기에는 어려움을 겪었다.
- 다른 접근으로는 좋은 semantic segmentation을 기반으로 instance segmentation을 수행하는 것이다. FCN outputs과 같이 pixel 단위로 classification을 수행하고 이 결과를 가지고 같은 카테고리에 있더라도 다른 instance로 잘라내려고 시도한다.
- Mask R-CNN은 이러한 segmentation first 기법과 다르게 instance first 기법을 사용한다. 그리고 앞으로 이 두가지 기법을 더 깊게 통합하는 연구가 향후에 있을 것으로 예상한다.

### 
# Conclusion
- 
<br><br>

# 개인적인 생각
- 

<br><br>

# 이미지 출처
- [Mask R-CNN Paper](https://arxiv.org/pdf/1703.06870.pdf)
